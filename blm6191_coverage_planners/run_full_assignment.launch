<launch>

  <!-- === Temel Argümanlar === -->
  <arg name="model" default="$(env TURTLEBOT3_MODEL)" doc="model type [burger, waffle, waffle_pi]"/>
  <arg name="world_file_name" default="turtlebot3_willowgarage.launch"/> <!-- Gazebo world launch file name -->
  <arg name="slam_methods" default="gmapping" doc="slam type [gmapping, cartographer, hector, karto, front_end]"/>
  <arg name="open_rviz_launch" default="true" doc="Launch RVIZ with custom config"/>
  <arg name="rviz_config_file_name" default="coverage_assignment.rviz"/>

  <!-- === Polygon Publisher için Argüman === -->
  <arg name="launch_polygon_publisher" default="false"/> <!-- true ise polygon_publisher_node başlar -->


  <!-- === Gazebo'yu Başlat === -->
  <include file="$(find turtlebot3_gazebo)/launch/$(arg world_file_name)">
    <arg name="model" value="$(arg model)"/>
  </include>

  <!-- === Robot State Publisher (TurtleBot3 için genellikle SLAM launch dosyasında bulunur) === -->
  <!-- Eğer SLAM launch dosyanız robot_state_publisher'ı başlatmıyorsa, buraya ekleyebilirsiniz:
  <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" output="screen">
    <param name="publish_frequency" type="double" value="50.0" />
  </node>
  -->

  <!-- === SLAM (GMapping) Başlat === -->
  <include file="$(find turtlebot3_slam)/launch/turtlebot3_slam.launch">
    <arg name="model" value="$(arg model)"/>
    <arg name="slam_methods" value="$(arg slam_methods)"/>
    <arg name="open_rviz" value="false"/> <!-- RVIZ'i aşağıda ayrı olarak başlatacağız -->
  </include>

  <!-- === Move Base'i Özel Planlayıcılarla Başlat === -->
  <include file="$(find blm6191_coverage_planners)/my_coverage_move_base.launch">
    <arg name="model" value="$(arg model)"/>
  </include>

  <!-- === RVIZ'i Başlat === -->
  <group if="$(arg open_rviz_launch)">
    <node name="rviz" pkg="rviz" type="rviz" args="-d $(find blm6191_coverage_planners)/$(arg rviz_config_file_name)" required="true"/>
  </group>

  <!-- === Teleop için bilgilendirme (launch dosyası bunu otomatik başlatamaz) === -->
  <!-- Kullanıcıya ayrı bir terminalde teleop başlatması gerektiğini hatırlatırız. -->
  <node name="teleop_reminder" pkg="rostopic" type="rostopic"
        args="echo 'TELEOP REMINDER: To manually control the robot for mapping, open a new terminal and run: roslaunch turtlebot3_teleop turtlebot3_teleop_key.launch'"
        output="screen" launch-prefix="bash -c 'sleep 15; $0 $@'"/>

  <!-- Load all planner params globally -->
  <rosparam file="$(find blm6191_coverage_planners)/planner_params.yaml" command="load" ns="/" />

</launch>
